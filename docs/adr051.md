---
title: Cloud Announcements
authors: 
- Guilherme Gazzo
state: committed
discussion: https://github.com/RocketChat/adrs/pull/39
tags: 
  - nbj
  - new-buyers-journey
---

## Introduction
This ADR addresses and describes the minimum requirements for effective communication between the cloud and instances.

Currently, the cloud is already capable of communicating with instances; however, the communication is limited.


## Proposal

Minimum requirements that we consider important:

- Translations
- Ability to dismiss or update the same Announcement
- New Surfaces
    - Modals
    - Info
    - Home

```typescript

// Data communication between cloud and instance

interface SyncPayloadCloud {
    announcements:{
        create: Announcement[];
        delete: string[];
    }
    // @deprecated
    banners: unknown[];
    nps: unknown[];
}

type AnnouncementPlatform = 'web' | 'mobile';

// TBD: Name the feature
export interface Announcement extends IRocketChatRecord {
    selector?: {
        roles?: string[];
    },
    platforms: AnnouncementPlatform[];
    expireAt: Date;
    startAt: Date;
    createdBy: 'cloud' | 'system';
    createdAt: Date;
    dictionary?: {
        [lng: string]: {
            [key: string]: string;
        }
    };
    view: UiKitBannerPayload;
    surface: 'banner' | 'modal' | 'info' | 'home';
}


```
## Translations
We understand that flexibility is the key to this functionality. We want the cloud to be capable of informing the user of any and all pertinent information.

Lacking translation capabilities greatly restricts the user experience. If we want to communicate with the user, this is crucial, and the experience needs to be seamless.

Uikit already allows translations, so the cloud would only need to provide the message dictionary.

## Dismiss or Update Announcements
Often, we need to convey the same information to the user but with a different value or provide a reminder. Currently, the system enforces creating new banners, piling up and causing confusion if the user does not dismiss them.

The new system should allow the cloud to update the same announcement with a new message or value.

This is going to be handled by an unique id that the cloud will provide. Cloud will be able to update the same announcement by providing the same id and only if the announcement was created by the cloud.

## New Surfaces
Currently, the cloud can only communicate with the user through banners. We want to expand the possibilities and allow the cloud to communicate with the user through modals, info, and home.

### Modal
Follows the same Uikit modal structure.
It requires a submit button to dismiss the modal.

### Info
Its purpose is to provide information to the admin. 
Probably will create a new Uikit Block and Element for this.

### Home
Same as info, but for the regular user.


## Action Handling 
The mechanism to handle actions is already in place. Used by the NPS feature.
Just a matter to create a new internal "app" id and redirect the actions to the cloud.
